[[!template  id=gitbranch branch=anarcat/master author="[[anarcat]]"]]

I got tired of hacking at the osm.pm every time I wanted to change the layers, so I made it so the layers can be changed in the .setup file. In my master branch, there are now two new configuration settings: `osm_layers` and `osm_layers_order` which replace the hackish `osm_mapurl`. The variables are a hash and an array that allow the operator to define the list of URLs to be loaded as layers and also to change the order of layers. -- [[users/anarcat]]

> I try to avoid adding hashes to config, because websetup does
> not allow configuring hashes.
> 
> The example for `osm_layers_order` is confusing, it makes
> it look like a perl hash, but it appears to really be a javascript
> code fragement string, and one that is tightly bound to other
> configuration too. Why not generate that javascript code from
> data in a robust way?
>
> Does it even make sense to configure this stuff globally?
> Could the layers be passed as parameters to the osm direction? --[[Joey]]
>
> > The reason for `osm_layers_order` is that order is important in the layers: the default layer is the first one and it's not possible to force Perl to have arrays generated in a reliable, reproducable order. Maybe an alternative would be to just set the default layer.
> > 
> > That said - maybe you're right and this should be passed as an argument to the OSM directive. The problem then is that you need to pass this stuff around the waypoint directive too. It also makes it hard to have a consistent set of maps all across the wiki. On our site, we have map inserts here and there, and it's nice to have them consistent all around.
> > 
> > In closing, I would say that I agree that `.._order` is confusing: maybe I should just have a `_default` to choose the first one? -- [[anarcat]]

>>> If there's no reason to order the other layers, that makes some sense.
>>> --[[Joey]]

>>>> The layers are ordered because that's the way they are displayed in the menu. Take a look at the base layers on the top left here for an idea: <http://wiki.reseaulibre.ca/ikiwiki.cgi?map=map&do=osm&zoom=12&lat=45.5227&lon=-73.59554>. -- [[anarcat]]
